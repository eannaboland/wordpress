function UpdraftCentral_Paginator(e,t,r){function a(){u>1&&(d(e),n(_))}function n(e){c.element.find(".page").each(function(t,r){jQuery(this).removeClass("page_active"),jQuery(this).attr("aria-selected",!1),jQuery(this).data("page")===e&&(jQuery(this).addClass("page_active"),jQuery(this).attr("aria-selected",!0))}),c.element.find(".page_prev").removeClass("disabled"),c.element.find(".page_next").removeClass("disabled"),1===e?c.element.find(".page_prev").addClass("disabled"):e===u&&c.element.find(".page_next").addClass("disabled"),l()}function o(){_<u&&(_++,n(_))}function i(){_>1&&(_--,n(_))}function s(e){e!==_&&(_=e,n(e))}function d(e){for(var t=[],r=1;r<=u;r++)t.push(r);c.element=jQuery(UpdraftCentral.template_replace("dashboard-paginator",{pages:t})),c.element.appendTo(e),c.element.on("click","a",function(e){if(e.preventDefault(),!jQuery(this).hasClass("active"))if(jQuery(this).hasClass("page_prev"))i();else if(jQuery(this).hasClass("page_next"))o();else if(jQuery(this).hasClass("page")){var t=jQuery(this).data("page");s(t)}})}function l(){c.element.trigger("page_change",_),jQuery.isFunction(p)&&p(_)}var c=this,_=t.current_page,u=t.total_pages,p=r;a(),this.page_change=function(e){p=e}}jQuery(document).ready(function(e){UpdraftCentral=UpdraftCentral()}),function(e){"use strict";e.console=e.console||{};for(var t,r,a=e.console,n={},o=function(){},i="memory".split(","),s="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=i.pop();)a[t]||(a[t]=n);for(;r=s.pop();)"function"!=typeof a[r]&&(a[r]=o)}("undefined"==typeof window?this:window);var UpdraftCentral=function(){function e(){h("#updraftcentral_dashboard_existingsites_container").off()}function t(){h("#updraftcentral_modal").off()}function r(){h("#updraftcentral_notice_container .updraftcentral_listener").each(function(e){var t=h(this).data("site_id"),r=h(this).data("type"),a=this,n=h('#updraftcentral_dashboard_existingsites .updraftcentral_site_row[data-site_id="'+t+'"'),o=h(this).data("finished");if(!o)if(u>1&&console.log("poll_listeners(): site_id="+t+", listener_type="+r),n.length>0&&g.hasOwnProperty(r)){var i=g[r].call(this,a,n,t);if(0===i)h(this).data("finished",!0),h("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_listener_finished_"+r,{site_id:t,site_row:n,listener_row:a,listener_type:r}),h(a).clearQueue().delay(1e4).slideUp("slow",function(){h(this).remove()});else if(1===i)h(this).data("finished",!0),h("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_listener_finished_"+r,{site_id:t,site_row:n,listener_row:a,listener_type:r});else if(null!=i&&i.hasOwnProperty("call")){var s=i.call;UpdraftCentral.send_site_rpc(i.call,i.data,n,function(e,r,o){"ok"==r&&!1!==e&&e.hasOwnProperty("data")&&(g.hasOwnProperty(s)?g[s].call(this,a,n,t,e.data):(console.log("UpdraftCentral: listener type "+s+" has no registered processor (dump of all registered processors follows)"),console.log(g)))})}}else n.length>0?(console.log("UpdraftCentral: listener type "+r+" has no registered processor (dump of all registered processors follows)"),console.log(g)):console.log("UpdraftCentral: listener for site_id="+t+" with type "+r+": site row not found")})}function a(e,t){var r=e.data("site_remote_public_key"),a=e.data("site_local_private_key"),o=this.get_contact_url(e),i=e.data("site_id"),s=e.data("key_name_indicator"),d=e.data("remote_user_id");("undefined"==typeof t||"direct_manual_auth"!=t&&"via_mothership"!=t&&"via_mothership_encrypting"!=t&&"direct_jquery_auth"!=t)&&(t="direct_default_auth"),"via_mothership_encrypting"==t&&(console.warn("UpdraftCentral: A site ("+i+", "+o+") routed via_mothership_encrypting was passed into get_site_udrpc"),console.log(e));var l=!1;if("direct_default_auth"==t){navigator.userAgent.toLowerCase().indexOf("firefox")>-1;connection_method="direct_jquery_auth"}else connection_method=t,"via_mothership"==connection_method&&(l={action:"updraftcentral_dashboard_ajax",subaction:"site_rpc",component:"dashboard",nonce:udclion.updraftcentral_dashboard_nonce,site_id:i,site_rpc_preencrypted:1});var c=e.data("send_cors_headers");"undefined"==typeof c&&(c=1);var _="direct_manual_auth"==connection_method?"manual":"jquery",p={},f=o;if("via_mothership_encrypting"!=connection_method&&"via_mothership"!=connection_method){var h=e.data("http_username");if("undefined"!=typeof h&&h){p.username=h;var m=e.data("http_password");"undefined"!=typeof m&&(p.password=m)}}else f=udclion.ajaxurl;u>0&&(console.log("UDRPC communications method: site_id="+i+", name_indicator="+s+", site_url="+o+", comms_url="+f+", remote_user_id="+d+", connection_method="+t+"/"+connection_method+", send_cors_headers="+c),u>1&&(console.log("Remote public key follows"),console.log(r)));var g=i+" "+connection_method;return n(g,d,s,r,a,f,c,p,_,l)}function n(e,t,r,a,n,o,s,d,l,c){if("undefined"!=typeof y[e])_=y[e];else{s="undefined"==typeof s||s;var _=new UpdraftPlus_Remote_Communications(r);_.set_key_local(n),_.set_key_remote(a),_.activate_replay_protection();var p=/\/admin-ajax.php$/;p.test(o)&&(o+="?action=updraft_central"),_.set_destination_url(o),"undefined"!=typeof d&&_.set_http_credentials(d),"undefined"!=typeof l&&_.set_auth_method(l),"undefined"!=typeof c&&!1!==c&&(_.set_message_wrapper(c),_.set_message_unwrapper(function(e){var t=i(e,2,!1);if(!0===t){if(e.hasOwnProperty("wrapped_response"))return e.wrapped_response;t="wrapped_response_not_found"}return console.error("UDRPC: Attempt to unwrap the message failed (code: "+t+")"),u>1&&console.log(e),!1})),_.set_cors_headers_wanted(s),y[e]=_}if(u>0){var f=u>2?2:1;_.set_debug_level(f)}return _}function o(e,t,r,a,n,o,i){var s="undefined"!=typeof i&&i&&i.length?i.data("site_description")+" - ":"";if(o="undefined"==typeof o||o,"error"==t?(console.error("process_ajax_response: return code: "+t+", error_code: "+r+" - parsed response follows"),console.log(e)):u>0&&(console.log("process_ajax_response: return code: "+t+" - parsed response follows"),console.log(e)),a&&"ok"==t&&e.hasOwnProperty("response")&&"rpcerror"==e.response&&(t="error",r="rpc_unknown_error",e.hasOwnProperty("data")&&e.data.hasOwnProperty("code"))){r=e.data.code,console.error("UpdraftCentral: RPC: Error occurred ("+r+"); data follows"),console.log(e.data),e=e.data.data;var d=n.call(this,e,t,r);if(!0!==d){var l=udclion.js_exception_occurred+" ("+r+")";udclion.rpcerrors.hasOwnProperty(r)&&(l=udclion.rpcerrors[r]),o&&UpdraftCentral_Library.dialog.alert("<h2>"+s+udclion.communications_error+"</h2>"+l)}}else{if("error"==t){var c=udclion.general_js_comms_failure,_=!0,p=udclion.error;2==a&&"unwrapper_failure"==r&&e.hasOwnProperty("code")&&(r=e.code),"json_parse_fail"==r?e.indexOf("<html")>-1&&(console.error("UpdraftCentral: JSON parse fail: looks like html was returned - remote plugin is probably not installed/inactive/blocked"),c=udclion.general_js_comms_failure,p=udclion.communications_error):"response_empty"==r||"http_post_fail"==r?(c=udclion.general_js_comms_failure,p=udclion.communications_error):"timeout"==r?(c=udclion.comms_failure_timeout,p=udclion.communications_error+" - "+udclion.timeout):"unauthorized"==r?(c=udclion.comms_failure_unauthorised,p=udclion.communications_error):"unknown_response"==r?(c=udclion.unknown_response,p=udclion.communications_error):"cannot_contact_localdev"==r?(p=udclion.communications_error,c=e.message,e.hasOwnProperty("request_info")&&e.request_info.hasOwnProperty("method")&&e.request_info.hasOwnProperty("use_method")&&e.request_info.method!=e.request_info.use_method&&(c+="<br>"+udclion.localdev_can_work_better_with_https)):"unexpected_http_code"==r&&a&&e.hasOwnProperty("data")&&null!==e.data&&e.data.hasOwnProperty("headers")&&e.data.headers.hasOwnProperty("www-authenticate")&&0==e.data.headers["www-authenticate"].search(/Digest/i)?(c=e.message,c+="<br>"+udclion.digest_auth_not_supported):"unexpected_http_code"==r&&a&&e.hasOwnProperty("data")&&null!==e.data&&e.data.hasOwnProperty("response")&&e.data.response.hasOwnProperty("code")&&401==e.data.response.code?c=udclion.comms_failure_unauthorised+' <a href="#" class="updraftcentral_site_editdescription">'+udclion.open_site_configuration+"...</a>":e.hasOwnProperty("message")?(c=e.message,a||(_=!1)):(_=!1,c+="<br>"+udclion.error_code+": "+r),e.hasOwnProperty("status")&&401==e.status?c=udclion.comms_failure_unauthorised+' <a href="#" class="updraftcentral_site_editdescription">'+udclion.open_site_configuration+"...</a>":"ns_error_dom_bad_uri: access to restricted uri denied"==r&&(c=udclion.comms_failure_unauthorised_by_browser+' <a href="#" class="updraftcentral_site_editdescription">'+udclion.open_site_configuration+"...</a>"),c="<p>"+c+"</p>",_&&(c+='<p><a href="'+udclion.common_urls.connection_checklist+'">'+udclion.go_here_for_connection_help+"</a></p>",c+='<p><a href="#" class="updraftcentral_test_other_connection_methods">'+udclion.test_other_connection_methods+"</a></p>"),e.hasOwnProperty("status")&&200!=e.status&&0!=e.status&&(c+="<p>"+udclion.http_response_status+": "+e.status+"</p>"),o&&UpdraftCentral_Library.dialog.alert("<h2>"+s+p+"</h2>"+c)}a&&e.hasOwnProperty("data")&&null!=e.data&&(e.data.hasOwnProperty("php_events")&&h.each(e.data.php_events,function(e,t){console.log("UpdraftCentral: PHP event on remote side: "+t)}),e.data.hasOwnProperty("caught_output")&&console.log("UpdraftCentral: direct output on remote side: "+e.data.caught_output),(e.data.hasOwnProperty("php_events")||e.data.hasOwnProperty("caught_output"))&&(e.data=e.data.previous_data)),n.call(this,e,t,r)}}function i(e,t,r,a,n){return a="undefined"==typeof a||a,e.hasOwnProperty("responsetype")&&"error"==e.responsetype?(e.hasOwnProperty("message")&&console.error("UpdraftCentral error via AJAX: "+e.message),"cannot_contact_localdev"==e.code&&(e.request_info={method:method,use_method:use_method}),!1!==r&&o(e,"error",e.code,t,r,a,n),e.code):e.hasOwnProperty("message")||e.hasOwnProperty("code")?(u>1&&console.log(e.responsetype+": "+e.message),t&&(e.hasOwnProperty("php_events")&&h.each(e.php_events,function(e,t){console.info("UpdraftCentral: PHP event on remote side: "+t)}),e.hasOwnProperty("mothership_caught_output")&&console.info("UpdraftCentral: direct output on remote side: "+e.caught_output),e.hasOwnProperty("rpc_response")&&(e=e.rpc_response)),!1!==r&&o(e,"ok",null,t,r,a,n),!0):(console.log(e),!1!==r&&o(e,"error","unknown_response",t,r,a,n),"unknown_response")}function s(){var e=h("#updraftcentral_dashboard_existingsites .updraftcentral_site_row:not(.updraft_site_unlicensed)").length;h("#updraftcentral_licences_in_use").html(e)}function d(e){if(e.hasOwnProperty("how_many_licences_in_use")&&h(".updraftcentral_licences_in_use").html(e.how_many_licences_in_use),e.hasOwnProperty("how_many_licences_available")){var t=e.how_many_licences_available<0?"&#8734;":e.how_many_licences_available;h(".updraftcentral_licences_total").html(t)}}function l(e,t){if("undefined"!=typeof e&&null!==e.match(/https?:\/\/updraft(plus|central)\.com/)){"undefined"!=typeof t&&t.preventDefault();var r=window.open(e,"_blank");UpdraftCentral_Library.focus_window_or_error(r)}}function c(){udclion.hasOwnProperty("handlebars")&&udclion.handlebars.hasOwnProperty("compile")&&h.each(udclion.handlebars.compile,function(e,t){console.log("UpdraftCentral: in developer mode: compile template: "+e),UpdraftCentral_Handlebars[e]=Handlebars.compile(t)})}var _,u="undefined"!=typeof udclion&&udclion.hasOwnProperty("debug_level")?udclion.debug_level:0,p=u>0?5e3:1e4,f=670,h=jQuery;this.site_order=function(){h("#updraftcentral_dashboard_existingsites").sortable({axis:"y",start:function(e,t){h(".updraft_site_actions").removeClass("open")},stop:function(e,t){site_order_array=h(this).sortable("toArray",{attribute:"data-site_id"}),UpdraftCentral.send_ajax("manage_site_order",{site_order:site_order_array},null,"via_mothership_encrypting",null,function(e,t,r){"ok"==t?e.hasOwnProperty("message")&&"fail"===e.message&&UpdraftCentral_Library.dialog.alert(udclion.error_saving_site_order):(console.log("Expected site order data not found:"),console.log(e))})}})},this.site_order(),Handlebars.registerHelper("ifeq",function(e,t,r){return"string"!=typeof e&&(e=e.toString()),"string"!=typeof t&&(t=t.toString()),e===t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifneq",function(e,t,r){return"string"!=typeof e&&(e=e.toString()),"string"!=typeof t&&(t=t.toString()),e!==t?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifset",function(e,t,r){return"string"!=typeof e&&(e=e.toString()),"string"!=typeof t&&(t=t.toString()),e===t?new Handlebars.SafeString(r+'="'+r+'"'):""}),Handlebars.registerHelper("ifempty",function(e,t){return"undefined"!=typeof e&&e&&e.length?"":new Handlebars.SafeString(t)}),this.set_current_site_row=function(e){UpdraftCentral.$site_row=e},this.register_event_handler=function(e,t,r){jQuery(document).off(e,t).on(e,t,r)},this.set_loading=function(e){e.css("opacity","0.3"),e.find("button").attr("disabled",!0),e.find('input[type="button"]').attr("disabled",!0)},this.done_loading=function(e,t){var r=jQuery.Deferred();return e.css("opacity","1.0"),t?e.slideUp(500,function(){e.html(t),r.resolve()}).slideDown(500):(e.find("button").attr("disabled",!1),e.find('input[type="button"]').attr("disabled",!1),r.resolve()),r.promise()},this.set_debug_level=function(e){u=e},this.get_debug_level=function(){return u},this.initiate_modal_close_listener=function(e){h('.modal-dialog button[data-dismiss="modal"]').on("click",function(){e.apply(null,[]),h('.modal-dialog button[data-dismiss="modal"]').off("click")})},this.open_modal=function(e,t,r,a,n,o,i,s){a="undefined"!=typeof a?a:udclion.go,o="undefined"==typeof o||o,i="undefined"!=typeof i?i:"",h("#updraftcentral_modal_dialog .modal-dialog").removeClass().addClass("modal-dialog "+i),h("#updraftcentral_modal_dialog .modal-title").html(e),o&&(t=UpdraftCentral_Library.sanitize_html(t)),h("#updraftcentral_modal_dialog .modal-body").html(t),!1===a?h("#updraftcentral_modal_dialog button.updraft_modal_button_goahead").hide():h("#updraftcentral_modal_dialog button.updraft_modal_button_goahead").html(a).show(),_=r,"undefined"!=typeof n&&null!==n&&n.call(this),"function"==typeof s&&s&&UpdraftCentral.initiate_modal_close_listener(s),h("#updraftcentral_modal_dialog").modal()},this.get_site_heading=function(e){var t=e.data("site_description"),r=e.data("site_url");t==r&&(t="");var a;return a=t?'<a href="'+r+'">'+t+"</a>":'<a href="'+r+'">'+r+"</a>"},this.close_modal=function(){h("#updraftcentral_modal_dialog").modal("hide")},this.register_row_clicker=function(e,t,r,a){a="undefined"!=typeof a?a:"click",r="undefined"!=typeof r&&r,params={},h("#updraftcentral_dashboard_existingsites_container").on(a,".updraftcentral_site_row "+e,params,function(e){"keypress"!=a&&e.preventDefault(),UpdraftCentral.$site_row=h(this).closest(".updraftcentral_site_row");var n=UpdraftCentral.$site_row.data("site_id");r&&(h('#updraftcentral_dashboard_existingsites .updraftcentral_site_row:not([data-site_id="'+n+'"]), #updraftcentral_dashboard_existingsites .updraftcentral_row_divider').slideUp(),h(".updraftcentral_mode_actions .updraftcentral_action_choose_another_site").show()),t.call(this,UpdraftCentral.$site_row,n,e)})};var m=this.register_row_clicker;this.register_modal_listener=function(e,t,r){r="undefined"!=typeof r?r:"click",params={},h("#updraftcentral_modal").on(r,e,params,function(e){t.call(this,e)})},h("#updraftcentral_modal_dialog button.updraft_modal_button_goahead").click(function(){!0===_?this.close_modal():_.call(this)});var g={};this.register_listener_processor=function(e,t){g[e]=t},setInterval(function(){r()},p);var y=[];this.get_contact_url=function(e){var t=e.data("admin_url").replace(/\/+$/,"");return t+"/admin-ajax.php"},this.send_ajax=function(e,t,r,n,s,d,l,c){var _="undefined"!=typeof r&&r&&r.length?r.data("site_description")+" - ":"";n="undefined"!=typeof n?n:"direct_default_auth",l="undefined"!=typeof l?l:30,s="undefined"!=typeof s?s:null,c="undefined"==typeof c||c;var p="via_mothership"==n||"via_mothership_encrypting"==n?"via_mothership"==n?"server_proxies":"server":"direct",f=null!==r;if(f){var m=r.data("site_unlicensed");if("undefined"!=typeof m&&m)return void UpdraftCentral_Library.dialog.alert("<h2>"+_+udclion.error+"</h2>"+udclion.site_unlicensed_message)}if(s&&h(s).prepend('<div class="updraftcentral_spinner"></div>'),"direct"==p&&"https:"==document.location.protocol){var g=this.get_contact_url(r);"http:"==g.substring(0,5).toLowerCase()&&(p="server")}if(u>0&&(console.log("send_message(ajax_method="+p+", requested_method="+n+", command="+e+", data(follows))"),console.log(t)),"direct"==p||"server_proxies"==p){if(!f)throw"send_ajax() called with direct method ("+n+"), but no site row object passed in";var y=a(r,n);y.send_message(e,t,l,function(e,t,a){s&&(h(s).removeClass("updraftcentral_spinner"),h(s).children(".updraftcentral_spinner").remove()),u>2&&(console.log("Raw response, pre-processing, follows"),console.log(e));var n="server_proxies"==p?2:1;try{o(e,t,a,n,d,c,r)}catch(i){UpdraftCentral_Library.dialog.alert("<h2>"+_+udclion.error+"</h2>"+udclion.js_exception_occurred+"<br>"+i.toString()),console.log(i)}})}else{var v=0;null!==r&&(v=r.data("site_id"));var b=f?"site_rpc":e,w=f?{command:e,data:t}:t,C={type:"POST",url:udclion.ajaxurl,timeout:1e3*l,headers:{"X-Secondary-User-Agent":"UpdraftCentral-dashboard.js/"+udclion.udc_version},data:{action:"updraftcentral_dashboard_ajax",subaction:b,component:"dashboard",nonce:udclion.updraftcentral_dashboard_nonce,site_id:v,data:w},dataType:"text",success:function(e){if(s&&h(s).children(".updraftcentral_spinner").remove(),"undefined"==typeof e||""===e)return console.log("UDRPC: the response from the remote site was empty"),void o(e,"error","response_empty",f,d,c,r);try{var t=JSON.parse(e)}catch(a){var n=e.match(/\{"format":.*}/);if(null===n)return console.log(a),console.log(e),void o(e,"error","json_parse_fail",f,d,c,r);e=n[0];try{var t=JSON.parse(e);console.log("UpdraftCentral: successfully parsed JSON after removing unwanted elements"),console.log(e)}catch(a){return console.log(a),console.log(e),void o(e,"error","json_parse_fail",f,d,c,r)}}e=t,i(e,f,d,c,r)},error:function(e,t,a){if(s&&h(s).children(".updraftcentral_spinner").remove(),console.error("UpdraftCentral: Error in AJAX operation"),console.log(e),console.log(t),console.error(a),""==a&&(a="http_post_fail"),a.hasOwnProperty("statusText")&&(a=a.statusText.toString()),"function"==typeof a.toLowerCase)a=a.toLowerCase();else try{var n=a.toString().toLowerCase();n&&(a=n)}catch(i){}o(e,"error",a,f,d,c,r)}};u>1&&(console.log("UpdraftCentral: jQuery POST: options follow:"),console.log(C)),jQuery.ajax(C)}},h("#updraftcentral_dashboard .updraft-mobile-menu").on("click",function(){var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0);e<=f&&(h("#updraftcentral_dashboard #updraft-central-navigation-sidebar").show(),h("#updraftcentral_dashboard .updraft-menu-item-links").slideToggle())}),this.set_existing_sites_to=function(e){y=[],h("#updraftcentral_dashboard_existingsites").html(e),UpdraftCentral.set_dashboard_mode(!0,!0),s()},h("#updraftcentral_dashboard .updraft-menu-item-links").on("click",function(e){e.stopPropagation();var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;t<f&&h("#updraftcentral_dashboard .updraft-menu-item-links").slideToggle()}),this.add_dashboard_notice_singleton=function(e,t,r,a,n){return t="undefined"==typeof t?"notice":t,r="undefined"==typeof r?3e4:r,a="undefined"==typeof extradata?{}:extradata,n="undefined"==typeof n?"":n,a.identifier=n,0===h('#updraftcentral_notice_container .updraftcentral_notice[data-identifier="'+n+'"]').length&&this.add_dashboard_notice(e,t,r,a)},this.add_dashboard_notice=function(e,t,r,a){r="undefined"!=typeof r?r:3e4,a="undefined"!=typeof a?a:{},t="undefined"!=typeof t?t:"notice";var n="notice",o="";"listener_"==t.substr(0,9)&&(n="listener",o="updraftcentral_listener updraftcentral_listener_"+t.substr(9),a.type=t.substr(9),t="info"),$container=h("#updraftcentral_notice_container");var i='<div class="updraftcentral_notice updraftcentral_notice_new updraftcentral_notice_level_'+t+" "+o+'"';h.each(a,function(e,t){i+="data-"+e+'="'+UpdraftCentral_Library.quote_attribute(t)+'"'});var s=h(i+'><button type="button" class="updraftcentral_notice_dismiss"></button><div class="updraftcentral_notice_contents">'+e+"</div></div>");return $container.append(s),r?s.slideDown("medium").delay(3e4).slideUp("slow",function(){h(this).remove()}):s.slideDown("medium"),s},this.create_dashboard_listener=function(e,t,r,a,n){a="undefined"==typeof a?{}:a,a.site_url=t.data("site_url"),a.site_id=t.data("site_id");var o="undefined"==typeof n?"<h2>"+t.data("site_description")+"</h2>":n;return this.add_dashboard_notice(o+r,"listener_"+e,!1,a)},h("#updraftcentral_notice_container").on("click",".updraftcentral_notice > .updraftcentral_notice_dismiss",function(){h(this).parents(".updraftcentral_notice").clearQueue().slideUp("slow",function(){h(this).remove()})}),this.get_dashboard_mode=function(){return h("#updraftcentral_dashboard").data("updraftcentral_mode")},this.set_dashboard_mode=function(r,a){a="undefined"!=typeof a;var n=this.get_dashboard_mode();!0===r&&(r=n),(a||r!=n)&&(n&&h("#updraftcentral_dashboard").removeClass("updraftcentral_mode_"+n),h("#updraftcentral_dashboard_existingsites_container .updraftcentral_row_extracontents").empty(),h("#updraftcentral_dashboard_existingsites .updraftcentral_site_row, #updraftcentral_dashboard_existingsites .updraftcentral_row_divider").show(),h("#updraftcentral_dashboard").data("updraftcentral_mode",r),h("#updraftcentral_dashboard").addClass("updraftcentral_mode_"+r),h("#updraft-menu-item-"+n).removeClass("updraft-menu-item-links-active"),h("#updraft-menu-item-"+r).addClass("updraft-menu-item-links-active"),h("#updraftcentral_dashboard .updraftcentral-hide-in-other-tabs:not(.updraftcentral-show-in-tab-"+r+"), #updraftcentral_dashboard .updraftcentral-hide-in-tab-"+r).hide(),h("#updraftcentral_dashboard .updraftcentral-show-in-tab-"+r+" .updraftcentral-hide-in-tab-initially").hide(),h("#updraftcentral_dashboard .updraftcentral-show-in-tab-"+r+", #updraftcentral_dashboard .updraftcentral-show-in-other-tabs:not(.updraftcentral-hide-in-tab-"+r+")").slideDown(1),e(),t(),h("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_set",{new_mode:r,previous_mode:n}),h("#updraftcentral_dashboard_existingsites").trigger("updraftcentral_dashboard_mode_set_"+r,{new_mode:r,previous_mode:n}))},h(".updraftcentral_mode_actions .updraftcentral_action_choose_another_site").click(function(){UpdraftCentral.set_dashboard_mode(!0,!0)}),h("#updraft-central-navigation-sidebar .updraft-menu-item").click(function(){var e=h(this).attr("id");if("undefined"!=typeof e){if("updraft-menu-item-"!=e.substring(0,18))return console.log("UDCentral: menu item without the ID in the expected format"),void console.log(this);var t=e.substring(18);UpdraftCentral.set_dashboard_mode(t)}}),h("#updraft-central-sidebar-button").click(function(){h("#updraft-central-navigation-sidebar").animate({width:"toggle"}),h(".updraft-central-sidebar-button-icon").toggle()}),h("#updraftcentral_dashboard .updraftcentral_action_box .updraftcentral_action_manage_sites").click(function(){UpdraftCentral.set_dashboard_mode("sites")}),h("#updraftcentral_dashboard_newsite").click(function(){var e=UpdraftCentral.get_advanced_site_options_html({http_username:"",http_password:""});UpdraftCentral.open_modal(udclion.add_site,UpdraftCentral.template_replace("sites-add-new-modal",{advanced_options:e}),function(){var e=h("#updraftcentral_addsite_key").val();if(UpdraftCentral.close_modal(),"undefined"!=typeof e&&null!==e&&""!==e){var t=UpdraftCentral_Library.get_serialized_options("#updraftcentral_modal #updraftcentral_editsite_expertoptions .expert_option"),r=h("#updraftcentral_modal #updraftcentral_site_send_cors_headers").is(":checked")?1:0,a=h("#updraftcentral_modal #updraftcentral_site_connection_method").val();UpdraftCentral.send_ajax("newsite",{key:e,extra_site_info:t,send_cors_headers:r,connection_method:a},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){if("ok"==t&&(e.hasOwnProperty("message")&&(add_dashboard_notice(e.message,"info"),e.hasOwnProperty("sites_html")?UpdraftCentral.set_existing_sites_to(e.sites_html):(console.log("Expected sites_html data not found:"),console.log(e)),e.hasOwnProperty("status_info")&&d(e.status_info)),e.hasOwnProperty("key_needs_sending"))){var a=e.key_needs_sending.key_site_id,n=e.key_needs_sending.url,o=h('#updraftcentral_dashboard_existingsites .updraftcentral_site_row[data-site_id="'+a+'"'),i=e.key_needs_sending.remote_public_key;h(o).prepend('<div class="updraftcentral_spinner"></div>');var s=n+"&action=updraftcentral_receivepublickey&updraft_key_index="+encodeURIComponent(e.key_needs_sending.updraft_key_index)+"&public_key="+encodeURIComponent(UpdraftCentral_Library.base64_encode(i)),l=window.open(s,"_blank","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=320");return void UpdraftCentral_Library.focus_window_or_error(l)}})}},udclion.add_site,function(){h("#updraftcentral_modal #updraftcentral_site_send_cors_headers").prop("checked",!0)},!1)}),h("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_set_sites",function(e){register_modal_listener("#updraftcentral_addsite_expertoptions_show",function(e){h(this).slideUp(),h("#updraftcentral_modal #updraftcentral_editsite_expertoptions .initially-hidden").show(),e.preventDefault()})}),h("#updraftcentral_notice_container").on("click","a",function(e){var t=h(this).attr("href");l(t,e)}),h("#updraftcentral_dashboard_existingsites").on("updraftcentral_dashboard_mode_set",function(e,t){register_modal_listener("a",function(e){var t=h(this).attr("href");l(t,e)}),h("#updraftcentral_dashboard_existingsites_container").on("click",".updraftcentral_site_row a",function(e){var t=h(this).attr("href");l(t,e)}),register_modal_listener("#updraft_debug_empty_browser_cache",function(e){for(var t=0,r=u>0,a=localStorage.length;a>=0;--a){var n=localStorage.key(a);null!==n&&"updraftcentral_"==n.substr(0,15)&&(r&&console.log("UpdraftCentral: Removing key from local storage: "+n),localStorage.removeItem(n),t++)}t>0?UpdraftCentral_Library.dialog.alert("<h2>"+udclion.empty+" "+udclion.browser_cache+"</h2>"+sprintf(udclion.cache_emptied,t)):UpdraftCentral_Library.dialog.alert("<h2>"+udclion.empty+" "+udclion.browser_cache+"</h2>"+udclion.cache_no_contents)}),register_modal_listener("#updraft_debug_show_browser_cache",function(e){for(var t=0,r=0,a=localStorage.length;r<a;++r){var n=localStorage.key(r),o=localStorage.getItem(n);"updraftcentral_"==n.substr(0,15)&&(t++,console.log(n+": "+o))}t>0?UpdraftCentral_Library.dialog.alert("<h2>"+udclion.log_contents+"</h2>"+udclion.cache_contents_logged):UpdraftCentral_Library.dialog.alert("<h2>"+udclion.log_contents+"</h2>"+udclion.cache_no_contents)}),t&&t.hasOwnProperty("new_mode")&&"notices"==t.new_mode||(register_modal_listener(".updraftcentral_site_editdescription",function(e){e.preventDefault(),open_site_configuration(UpdraftCentral.$site_row)}),register_modal_listener(".updraftcentral_test_other_connection_methods",function(e){e.preventDefault(),UpdraftCentral_Library.open_connection_test(UpdraftCentral.$site_row)}),register_modal_listener("a.connection-test-switch",function(e){e.preventDefault();var t=h(this).data("connection_method");UpdraftCentral.close_modal();var r=h(this).data("site_id");UpdraftCentral.send_ajax("edit_site_connection_method",{site_id:r,connection_method:t},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("message")&&add_dashboard_notice(e.message),e.hasOwnProperty("sites_html")?(UpdraftCentral.set_existing_sites_to(e.sites_html),s()):(console.log(e),add_dashboard_notice(udclion.unknown_response,"error")),e.hasOwnProperty("status_info")&&d(e.status_info))})}),register_modal_listener(".updraftcentral_siteinfo_results .phpinfo",function(e){e.preventDefault(),UpdraftCentral.send_site_rpc("core.phpinfo",null,UpdraftCentral.$site_row,function(e,t,r){if("ok"==t&&e.data){var a="";h.each(e.data,function(e,t){a+="<h3>"+e+"</h3>\n<table>\n",h.each(t,function(e,t){t.constructor===Array?a+="<tr><td>"+e+"</td><td>"+t[0]+"</td><td>"+t[1]+"</td></tr>\n":"string"==typeof t?a+=h.isNumeric(e)?"<tr><td></td><td>"+t+"</td></tr>\n":"<tr><td>"+e+"</td><td>"+t+"</td></tr>\n":(console.log("UpdraftCentral: phpinfo: Unrecognised output for key "+e+" (follows)"),console.log(t))}),a+="</table>\n"}),UpdraftCentral.open_modal(udclion.phpinfo,'<div id="updraftcentral_phpinfo_results">'+a+"</div>",null,!1,null,!0,"modal-lg")}},h(this))}),register_modal_listener("#updraftcentral_site_connection_method",function(){var e=h("#updraftcentral_site_connection_method").val();null!=e&&("direct_"==e.substring(0,7)&&"https:"==document.location.protocol?h("#updraftcentral_site_connection_method_message").show().html(udclion.http_must_go_via_mothership):h("#updraftcentral_site_connection_method_message").hide())},"change"),m(".updraftcentral_site_adddescription",function(e){open_site_configuration(e)}),m(".updraftcentral_site_delete",function(e){UpdraftCentral_Library.dialog.confirm("<h2>"+udclion.remove_site+"</h2><p>"+e.data("site_url")+"</p><p>"+udclion.really_delete_site+"</p>",function(t){if(t){var r=UpdraftCentral.$site_row.data("site_id");r&&(e.slideUp("slow"),UpdraftCentral.send_ajax("delete_site",{site_id:r},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("message")&&add_dashboard_notice(e.message),e.hasOwnProperty("sites_html")?UpdraftCentral.set_existing_sites_to(e.sites_html):(console.log(e),add_dashboard_notice(udclion.unknown_response,"error")),e.hasOwnProperty("status_info")&&d(e.status_info))}))}})}),m(".row_siteinfo",function(e){UpdraftCentral.send_site_rpc("core.site_info",null,e,function(e,t,r){if(u>1&&(console.log("send_site_rpc(site_info): parsed response follows"),console.log(e)),"ok"==t&&!1!==e){var a=e.data.versions,n=e.data.bloginfo,o=UpdraftCentral_Library.sanitize_html(n.url),i=(UpdraftCentral_Library.sanitize_html(n.name),a.ud);"none"==i&&(i=udclion.updraftplus.version_none);var s=sprintf(udclion.what_remote_running,a.wp,a.php,a.mysql,i,a.udrpc_php);UpdraftCentral.open_modal(UpdraftCentral_Library.sanitize_html(n.name),UpdraftCentral.template_replace("dashboard-siteinfo",{url:o,message:s,phpinfo:udclion.phpinfo}),null,!1)}})}),m(".updraftcentral_site_dashboard",function(e){UpdraftCentral_Library.open_browser_at(e)}))}),this.get_advanced_site_options_html=function(e){return UpdraftCentral.template_replace("sites-advanced-site-options",e)},this.open_site_configuration=function(e){var t=e.data("site_url"),r=e.data("http_username");"undefined"==typeof r&&(r="");var a=e.data("http_password");"undefined"==typeof a&&(a="");var n=e.data("connection_method");"undefined"==typeof n&&(n="direct_default_auth");var o=e.data("http_authentication_method");"undefined"==typeof o&&(o="basic");var i=e.data("site_description");i==t&&(i="");var l=e.data("send_cors_headers");("undefined"==typeof l||l)&&(l=1);var c=UpdraftCentral.get_advanced_site_options_html({http_username:r,http_password:a});UpdraftCentral.open_modal(udclion.edit_site_configuration,UpdraftCentral.template_replace("sites-edit-configuration",{site_url:t,advanced_options:c},{existing_description:i}),function(){var t=h("#updraftcentral-edit-site-description").val(),r=h("#updraftcentral_modal #updraftcentral_site_send_cors_headers").is(":checked")?1:0,a=h("#updraftcentral_modal #updraftcentral_site_connection_method").val(),n=e.data("site_id");if(n){UpdraftCentral.close_modal();var o=UpdraftCentral_Library.get_serialized_options("#updraftcentral_modal .expert_option");
UpdraftCentral.send_ajax("edit_site_configuration",{site_id:n,description:t,extra_site_info:o,send_cors_headers:r,connection_method:a},null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("message")&&add_dashboard_notice(e.message),e.hasOwnProperty("sites_html")?(UpdraftCentral.set_existing_sites_to(e.sites_html),s()):(console.log(e),add_dashboard_notice(udclion.unknown_response,"error")),e.hasOwnProperty("status_info")&&d(e.status_info))})}},udclion.edit,function(){h("#updraftcentral_modal #updraftcentral_site_connection_method").val(n).change(),l&&h("#updraftcentral_modal #updraftcentral_site_send_cors_headers").prop("checked",!0),h("#updraftcentral_modal #updraftcentral_addsite_http_authentication_method").val(o)},!1)},this.debugging_send_command=function(e,t,r,a){var n=h("#updraftcentral_dashboard_existingsites").find('.updraftcentral_site_row[data-site_url="'+r+'"]').first();return n.length<1?void console.log("debugging_send_command: no corresponding row found for the specified URL"):(a="undefined"!=typeof a?a:30,void UpdraftCentral.send_site_rpc(e,t,n,function(e,t,r){},null,a))};var v=function(e){return!(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e&&"undefined"!=typeof e&&!jQuery.isPlainObject(e)&&!Array.isArray(e))};return this.is_serializable=function(e,t){if(!v(e))return"undefined"!=typeof t&&t?{status:!1,data:e,error_field:t,error_type:typeof e[t],error_value:e[t]}:{status:!1};for(var t in e){if(!v(e[t]))return{status:!1,data:e,error_field:t,error_type:typeof e[t],error_value:e[t]};if("object"==typeof e[t]){var r=UpdraftCentral.is_serializable(e[t],t);if(r.hasOwnProperty("status")&&!r.status)return{status:!1,data:r.data,error_field:r.error_field,error_type:typeof r.data[r.error_field],error_value:r.data[r.error_field]}}}return!0},this.send_site_rpc=function(e,t,r,a,n,o){var i=UpdraftCentral.is_serializable(t);if(null!==t&&i.hasOwnProperty("status")&&!i.status)console.log("UpdraftCentral: send_site_rpc("+e+") - the submitted data parameter contains unserializable types (follows)"),i.hasOwnProperty("error_field")&&i.error_field?(console.log("Error field: "+i.error_field),console.log("Error type: "+i.error_type),console.log("Error value follows:"),console.log(i.error_value)):console.log(t),a.call(this,{error:udclion.js_exception_occurred},"error",null);else{o="undefined"!=typeof o?o:30;var s=r.data("site_id");s||(console.log("UpdraftCentral: sent_site_rpc("+e+") command sent, but site ID could not be identified from the row (follows)"),console.log(r));var d=r.data("connection_method");"undefined"!=typeof n&&null!==n||(n=r);try{return UpdraftCentral.send_ajax(e,t,r,d,n,a,o)}catch(l){n&&h(n).children(".updraftcentral_spinner").remove();var c=a.call(this,{error:l.toString()},"error",null);if("undefined"==typeof c||!c){var _="undefined"!=typeof r&&r.length?r.data("site_description")+" - ":"";UpdraftCentral_Library.dialog.alert("<h2>"+_+udclion.error+"</h2>"+udclion.js_exception_occurred+"<br>"+l.toString()),console.log(l)}}}},h("#updraftcentral_dashboard .updraft-central-logo img").dblclick(function(){UpdraftCentral_Library.toggle_fullscreen()}),h("#updraft-central-navigation .updraft-full-screen").on("click",function(){UpdraftCentral_Library.toggle_fullscreen()}),h("#updraft-central-navigation .updraftcentral-help").on("click",function(){UpdraftCentral_Library.dialog.alert(UpdraftCentral.template_replace("dashboard-help",{uc_version:udclion.updraftcentral_version+": "+udclion.udc_version,running_on:UpdraftCentral.version_info_as_text()}))}),this.version_info_as_text=function(){return"WP/"+udclion.wp_version+" PHP/"+udclion.php_version+" MySQL/"+udclion.mysql_version+" Curl/"+udclion.curl_version},h("#updraft-central-navigation .updraftcentral-settings").on("click",function(){UpdraftCentral.open_modal(udclion.settings,UpdraftCentral.template_replace("dashboard-settings",{uc_version:udclion.updraftcentral_version+": "+udclion.udc_version,running_on:UpdraftCentral.version_info_as_text()}),function(){var e=h("#updraftcentral_debug_level").val();e>=0&&e<=3&&UpdraftCentral.set_debug_level(e),UpdraftCentral.close_modal()},udclion.save_settings,function(){h("#updraftcentral_debug_level").val(u)})}),h(".updraftcentral_row_extracontents").on("click",".dashicons-image-rotate",function(){h(".dashicons-image-rotate").addClass("dashicon-image-rotating")}),this.template_replace=function(e,t,r){return t="undefined"==typeof t?{}:t,UpdraftCentral_Handlebars.hasOwnProperty(e)||(console.log("UDCentral: UpdraftCentral_Handlebars template not found: "+e),console.log(UpdraftCentral_Handlebars)),"undefined"!=typeof r&&h.each(r,function(e,r){t[e]=UpdraftCentral_Library.quote_attribute(r)}),t.udclion=udclion,"object"==typeof UpdraftCentral_Handlebars[e]?UpdraftCentral_Handlebars[e].handlebars(t):UpdraftCentral_Handlebars[e](t)},UpdraftCentral_Handlebars="undefined"==typeof UpdraftCentral_Handlebars?{}:UpdraftCentral_Handlebars,Handlebars.registerHelper("uc_each",function(e,t){var r="";if("undefined"==typeof e)return r;for(var a=0,n=e.length;a<n;a++){var o=e[a];o.as_json=JSON.stringify(o),o.udclion=udclion,r+=t.fn(o)}return r}),c(),s(),set_dashboard_mode("sites"),"undefined"==typeof Modernizr||Modernizr.lastchild?(h("#updraftcentral_dashboard_loading").fadeOut(),h("#updraftcentral_dashboard_existingsites_container").fadeIn(),udclion.hasOwnProperty("show_licence_counts")&&udclion.show_licence_counts&&h(".updraftcentral_licence_info").show(),setInterval(function(){UpdraftCentral.send_ajax("sites_html",null,null,"via_mothership_encrypting","#updraftcentral_dashboard_existingsites",function(e,t,r){"ok"==t&&(e.hasOwnProperty("sites_html")?UpdraftCentral.set_existing_sites_to(e.sites_html):(console.log("Expected sites_html data not found:"),console.log(e)),e.hasOwnProperty("status_info")&&d(e.status_info))})},864e5)):(console.log("UDCentral: Unsupported web browser"),h("#updraftcentral_dashboard_loading").fadeOut(),h("#updraftcentral_updraftplus_actions, #updraftcentral_sites_actions, #updraftcentral_dashboard_existingsites_container").remove(),this.add_dashboard_notice(udclion.unsupported_browser,"error",!1)),h("#updraftcentral_notice_container .updraftcentral_notice.remove_after_load").delay(3e4).slideUp("slow",function(){h(this).remove()}),h("#updraftcentral_modal_dialog").appendTo(document.body),this.storage_set=function(e,t,r){if("undefined"!=typeof r&&r){var a=Math.floor(Date.now()/1e3);localStorage.setItem("updraftcentral_saved_at_"+e,a)}u>1&&console.log("UpdraftCentral.storage_set(key="+e+")"),localStorage.setItem("updraftcentral_"+e,JSON.stringify(t))},this.storage_get=function(e,t){if("undefined"!=typeof t&&t>0){var r=localStorage.getItem("updraftcentral_saved_at_"+e);if(!r)return null;var a=Math.floor(Date.now()/1e3),n=a-r;if(UpdraftCentral.updraftcentral_debug_level>1&&console.log("UpdraftCentral.storage_get(key="+e+", maximum_age="+t+"): stored_at="+r+", epoch_time="+a+", stored_ago="+n),n>t)return null}var o=localStorage.getItem("updraftcentral_"+e);if("undefined"==typeof o)return null;try{var i=JSON.parse(o);return i}catch(s){}return null},this.storage_remove=function(e){return localStorage.removeItem("updraftcentral_saved_at_"+e),localStorage.removeItem("updraftcentral_"+e)},this};